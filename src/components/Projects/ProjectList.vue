<template>
  <div>
    <div
        v-for="(project, index) in projects"
        :key="index"
        class="projects__body-element"
    >

      <div class="projects__btn">
        <div class="projects__btn-list">
          <button>
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                  d="M3 11H9.5C9.76522 11 10.0196 10.8946 10.2071 10.7071C10.3946 10.5196 10.5 10.2652 10.5 10V2C10.5 1.73478 10.3946 1.48043 10.2071 1.29289C10.0196 1.10536 9.76522 1 9.5 1H2.5C2.23478 1 1.98043 1.10536 1.79289 1.29289C1.60536 1.48043 1.5 1.73478 1.5 2V10C1.5 10.2652 1.60536 10.5196 1.79289 10.7071C1.98043 10.8946 2.23478 11 2.5 11H3ZM6 2.4995C6.8235 2.4995 7.5 3.175 7.5 3.9995C7.5 4.8235 6.8235 5.5 6 5.5C5.1765 5.5 4.5 4.8235 4.5 3.9995C4.5 3.175 5.1765 2.4995 6 2.4995ZM3 8.625C3 7.5155 4.3525 6.375 6 6.375C7.6475 6.375 9 7.5155 9 8.625V9H3V8.625Z"
                  fill="#B4B8CC"/>
            </svg>
          </button>
          <button>
            <svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                  d="M4.11007 2.91808C4.12731 3.02521 4.12183 3.13476 4.09398 3.23963C4.06613 3.3445 4.01654 3.44235 3.94843 3.52681C4.36987 4.24719 4.94967 4.86227 5.64393 5.32549C5.76086 5.40459 5.88123 5.47337 5.98784 5.54215C6.09708 5.42139 6.2412 5.33763 6.4002 5.3025C6.5592 5.26738 6.7252 5.28262 6.87514 5.34612C7.41122 4.63609 7.77715 3.81247 7.94472 2.93871C6.70517 2.50092 5.35425 2.49365 4.11007 2.91808V2.91808Z"
                  fill="#B4B8CC"/>
              <path
                  d="M5.15211 0.211426C3.87514 0.211426 2.65047 0.7187 1.74752 1.62165C0.844569 2.52461 0.337296 3.74927 0.337296 5.02624C0.337296 5.181 0.337296 5.33233 0.36137 5.48365C0.449993 6.41231 0.806487 7.29522 1.38752 8.02507C1.96854 8.75491 2.74908 9.30024 3.63424 9.59478C4.51941 9.88931 5.47107 9.92036 6.37355 9.68415C7.27603 9.44794 8.09045 8.95464 8.71782 8.26422C9.34518 7.57381 9.75847 6.71601 9.90744 5.7951C10.0564 4.87419 9.93464 3.92984 9.55694 3.07684C9.17924 2.22384 8.56187 1.49893 7.77989 0.990242C6.99791 0.48155 6.08499 0.210981 5.15211 0.211426V0.211426ZM8.71163 6.77677C8.21029 6.77503 7.71114 6.71032 7.22592 6.58418C7.11064 6.74086 6.94145 6.84934 6.75095 6.88871C6.56045 6.92808 6.36212 6.89556 6.19417 6.7974C5.48713 7.36636 4.66616 7.77685 3.78677 8.00111C3.76009 8.14265 3.69592 8.27444 3.60094 8.38272C3.50597 8.491 3.38367 8.57181 3.24682 8.61672L3.14708 8.63735C2.70215 8.39137 2.30682 8.06484 1.98121 7.67439H2.20819C2.24109 7.51063 2.32433 7.36123 2.44629 7.2471C2.56824 7.13297 2.72282 7.0598 2.8884 7.03782C3.05398 7.01584 3.22229 7.04616 3.3698 7.12453C3.51731 7.2029 3.63664 7.3254 3.7111 7.47492C4.49073 7.26913 5.21914 6.90375 5.85026 6.4019C5.79518 6.27538 5.77385 6.13674 5.78835 5.99952C5.64391 5.91698 5.49946 5.831 5.35846 5.73815C4.60923 5.24138 3.98057 4.58334 3.51851 3.81222C3.38042 3.85013 3.23464 3.85001 3.09661 3.81187C2.95858 3.77373 2.83342 3.69899 2.73439 3.59555C2.09467 4.06417 1.51689 4.61191 1.01481 5.22571V5.02968C1.01648 4.83045 1.03257 4.63161 1.06296 4.43471C1.47548 3.92845 1.96252 3.4878 2.5074 3.12783C2.48806 2.976 2.51357 2.82183 2.58079 2.68433C2.64802 2.54683 2.75401 2.432 2.88571 2.35402C2.84444 2.20613 2.80317 2.05825 2.77222 1.90693C2.77222 1.85878 2.77222 1.80719 2.73439 1.68682C2.88451 1.57657 3.04192 1.47661 3.20555 1.38762C3.23994 1.59053 3.2537 1.69714 3.27777 1.80375C3.30185 1.91037 3.34655 2.09608 3.38782 2.24053H3.4738C3.6212 2.27462 3.75594 2.34973 3.86243 2.45719C5.20873 1.98241 6.67554 1.97393 8.02724 2.43312V2.0892C8.41118 2.46749 8.71729 2.91732 8.9283 3.41328C8.76093 3.31469 8.59126 3.22527 8.41931 3.14502C8.22409 4.06612 7.82579 4.93205 7.25343 5.67968C7.32738 5.80341 7.36659 5.94479 7.36692 6.08894C7.93233 6.20597 8.50928 6.2579 9.0865 6.2437C9.02883 6.42374 8.95873 6.59956 8.87671 6.76989L8.71163 6.77677Z"
                  fill="#B4B8CC"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="projects__body__name">
        <div class="projects__body__name-logo">
          <img
              v-if="project.photo"
              :src="domain + project.photo"
          >
          <div v-else :style="`background:${project.color};`">
            {{ project.title.charAt(0).toUpperCase() || '--' }}
          </div>
        </div>
        <div class="projects__body__name-text">{{ project.title || '--' }}</div>
      </div>
      <div class="projects__body__description">{{ project.description || '--' }}</div>
      <div class="projects__body__deadline ">{{ project.deadline || '--' }}</div>
      <div class="projects__body__status">
        <div
            class="projects__progress"
            v-if="project.task_count !== 0"
            :class="{
              progress__bad:(project.approved_count * 100 / project.task_count) <= 20,
              progress__good:(project.approved_count * 100 / project.task_count) >= 20,
              progress__ok:(project.approved_count * 100 / project.task_count) >= 70,
            }"
        >
          <span :style="`width: ${project.approved_count * 100 / project.task_count }%`"></span>
        </div>
        <span v-if="project.task_count !== 0">
          {{project.approved_count+"/"+project.task_count}}
        </span>
        <span v-else>--</span>
      </div>
      <div
          class="projects__body__paid"
         :class="{
            progress__bad:project.paid_percent <= 20,
            progress__good:project.paid_percent >= 20,
            progress__ok:project.paid_percent >= 70,
          }"
      >{{ !(project.paid_percent==null) ? parseInt(project.paid_percent) +"%" : false || '--' }}</div>
      <div class="projects__btn-right">
        <div class="projects__btn-list" v-if="archive === 'active'">

          <button @click.prevent="archivePush(project.id)">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12.5829 1.7998H5.41624C5.41624 1.7998 4.51984 1.7998 4.51984 2.6998H13.4793C13.4793 1.7998 12.5829 1.7998 12.5829 1.7998ZM15.2712 4.4998C15.2712 3.5998 14.3757 3.5998 14.3757 3.5998H3.62434C3.62434 3.5998 2.72884 3.5998 2.72884 4.4998V5.3998H15.2712V4.4998ZM17.0622 5.3998L16.533 4.867V6.2998H1.46704V4.867L0.93694 5.3998C0.40684 5.9326 0.0270396 6.0748 0.24034 7.1998C0.45274 8.3212 1.48144 14.4682 1.63444 15.2998C1.80184 16.2124 2.72974 16.1998 2.72974 16.1998H15.2721C15.2721 16.1998 16.1991 16.2124 16.3674 15.2998C16.5204 14.4682 17.5482 8.3212 17.7615 7.1998C17.973 6.0748 17.5932 5.9326 17.0622 5.3998ZM12.6 10.7971C12.6 11.2957 12.1959 11.6998 11.6973 11.6998H6.30274C6.06333 11.6998 5.83372 11.6047 5.66443 11.4354C5.49514 11.2661 5.40004 11.0365 5.40004 10.7971V8.9998H6.30004V10.7998H11.7V8.9998H12.6V10.7971Z" fill="#CBCFE6"/>
            </svg>
          </button>
        </div>
        <div class="projects__btn-list" v-else>
          <button @click.prevent="$router.push(`/put-projects/${project.id}`)">
            <svg width="19" height="18" viewBox="0 0 19 18" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M5.32407 13.2188C5.35923 13.2188 5.39438 13.2152 5.42954 13.21L8.38618 12.6914C8.42134 12.6844 8.45474 12.6686 8.47935 12.6422L15.9307 5.19082C15.947 5.17456 15.9599 5.15524 15.9688 5.13398C15.9776 5.11271 15.9821 5.08992 15.9821 5.06689C15.9821 5.04387 15.9776 5.02108 15.9688 4.99981C15.9599 4.97855 15.947 4.95923 15.9307 4.94297L13.0092 2.01973C12.9758 1.98633 12.9319 1.96875 12.8844 1.96875C12.837 1.96875 12.793 1.98633 12.7596 2.01973L5.30825 9.47109C5.28188 9.49746 5.26606 9.5291 5.25903 9.56426L4.74048 12.5209C4.72338 12.6151 4.72949 12.712 4.75828 12.8033C4.78707 12.8945 4.83768 12.9774 4.90571 13.0447C5.02173 13.1572 5.16763 13.2188 5.32407 13.2188V13.2188ZM6.50884 10.1531L12.8844 3.7793L14.1729 5.06777L7.79731 11.4416L6.23462 11.7176L6.50884 10.1531V10.1531ZM16.2629 14.6953H3.32544C3.01431 14.6953 2.76294 14.9467 2.76294 15.2578V15.8906C2.76294 15.968 2.82622 16.0312 2.90356 16.0312H16.6848C16.7622 16.0312 16.8254 15.968 16.8254 15.8906V15.2578C16.8254 14.9467 16.5741 14.6953 16.2629 14.6953Z" fill="#B4B8CC"/>
            </svg>
          </button>
          <button @click.prevent="archivePush(project.id)">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12.5829 1.7998H5.41624C5.41624 1.7998 4.51984 1.7998 4.51984 2.6998H13.4793C13.4793 1.7998 12.5829 1.7998 12.5829 1.7998ZM15.2712 4.4998C15.2712 3.5998 14.3757 3.5998 14.3757 3.5998H3.62434C3.62434 3.5998 2.72884 3.5998 2.72884 4.4998V5.3998H15.2712V4.4998ZM17.0622 5.3998L16.533 4.867V6.2998H1.46704V4.867L0.93694 5.3998C0.40684 5.9326 0.0270396 6.0748 0.24034 7.1998C0.45274 8.3212 1.48144 14.4682 1.63444 15.2998C1.80184 16.2124 2.72974 16.1998 2.72974 16.1998H15.2721C15.2721 16.1998 16.1991 16.2124 16.3674 15.2998C16.5204 14.4682 17.5482 8.3212 17.7615 7.1998C17.973 6.0748 17.5932 5.9326 17.0622 5.3998ZM12.6 10.7971C12.6 11.2957 12.1959 11.6998 11.6973 11.6998H6.30274C6.06333 11.6998 5.83372 11.6047 5.66443 11.4354C5.49514 11.2661 5.40004 11.0365 5.40004 10.7971V8.9998H6.30004V10.7998H11.7V8.9998H12.6V10.7971Z" fill="#CBCFE6"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
export default {
  data(){
    return{
      progress: 'progress__bad',
      domain: process.env.VUE_APP_DOMAIN
    }
  },
  methods:{
    async archivePush(id){
      try {
        if (this.archive === 'active'){
          await this.$store.dispatch('archivePush', {id, status: 0})
          await this.$store.dispatch("fetchProjectsArchive", 1);
          this.$store.commit("setNotification", "project-archive-success-false");
        }else{
          await this.$store.dispatch('archivePush', {id, status: 1})
          await this.$store.dispatch("fetchProjectsArchive", 0);
          this.$store.commit("setNotification", "project-archive-success");
        }
      }catch (e) {

      }

    }
  },
  props: {
    projects: {},
    archive: String,
  },
};
</script>

<style>
</style>